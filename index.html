<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPL Score Predictor</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            padding: 2rem;
            margin: 0;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background-color: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #37003c;
            text-align: center;
            margin-bottom: 2rem;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .column h2 {
            color: #555;
            border-bottom: 2px solid #37003c;
            padding-bottom: 0.5rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th,
        td {
            padding: 0.8rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
            font-size: 0.95rem;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        .score {
            font-weight: bold;
            color: #37003c;
        }

        .actual-score {
            font-weight: bold;
            color: #007bff;
        }

        .correct {
            color: #28a745;
            font-weight: bold;
        }

        .incorrect {
            color: #dc3545;
        }

        .prediction-box {
            background: #fff;
            border: 1px solid #eee;
            border-radius: 8px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Premier League Predictions</h1>

        <div id="accuracy-box"
            style="text-align: center; padding: 1rem; margin-bottom: 1.5rem; background: linear-gradient(135deg, #37003c 0%, #00ff85 100%); border-radius: 8px; color: white;">
            <span style="font-size: 1.1rem;">Winner Prediction Accuracy:</span>
            <span id="accuracy-value"
                style="font-size: 1.5rem; font-weight: bold; margin-left: 0.5rem;">Loading...</span>
            <span id="accuracy-detail" style="font-size: 0.9rem; margin-left: 0.5rem; opacity: 0.9;"></span>
        </div>

        <div class="grid">
            <!-- Left Column: Past Results -->
            <div class="column">
                <h2>Last Round Results</h2>
                <div class="prediction-box">
                    <table id="past-table">
                        <thead>
                            <tr>
                                <th>Match</th>
                                <th>Predicted</th>
                                <th>Actual</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Right Column: Upcoming -->
            <div class="column">
                <h2>Upcoming Predictions</h2>
                <div class="prediction-box">
                    <table id="upcoming-table">
                        <thead>
                            <tr>
                                <th>Match</th>
                                <th>Prediction</th>
                                <th>xG</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="last-updated" id="last-updated"></div>

        <!-- Modeling Details Section -->
        <div
            style="margin-top: 2rem; padding: 1.5rem; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #37003c;">
            <h2 style="color: #37003c; margin-top: 0;">How It Works</h2>

            <h3 style="font-size: 1rem; color: #555; margin-bottom: 0.5rem;">üìä The Model</h3>
            <p style="color: #666; line-height: 1.6; margin-bottom: 1rem;">
                We use a <strong>Poisson regression model</strong> to predict expected goals for each team.
                The model learns <em>team attack strength</em> and <em>defensive weakness</em> by analyzing
                how each team performs across all matches in the current season.
            </p>

            <h3 style="font-size: 1rem; color: #555; margin-bottom: 0.5rem;">‚öΩ Features Used</h3>
            <ul style="color: #666; line-height: 1.8; margin-bottom: 1rem; padding-left: 1.5rem;">
                <li><strong>Team Effects:</strong> Attack strength for home team, defensive weakness for opponent</li>
                <li><strong>League Position:</strong> Current standings in the table</li>
                <li><strong>Rolling Stats:</strong> Goals, shots, and shots on target (last 5 games)</li>
            </ul>

            <h3 style="font-size: 1rem; color: #555; margin-bottom: 0.5rem;">üîÑ Daily Updates</h3>
            <p style="color: #666; line-height: 1.6; margin-bottom: 1rem;">
                The model is <strong>retrained daily</strong> using all matches played so far this season.
                As more games are played, the model learns better estimates of each team's true strength.
            </p>

            <h3 style="font-size: 1rem; color: #555; margin-bottom: 0.5rem;">üìà Expected Goals (xG)</h3>
            <p style="color: #666; line-height: 1.6; margin-bottom: 0;">
                The xG column shows the model's expected goals for each team. For example, "1.5 - 0.8" means
                the home team is expected to score 1.5 goals on average, while the away team is expected to score 0.8.
                The predicted score rounds these values to the nearest whole number.
            </p>

            <p style="color: #999; font-size: 0.85rem; margin-top: 1.5rem; font-style: italic;">
                ‚ö†Ô∏è This is an experimental project for learning purposes. Predictions should not be used for any real
                decisions.
            </p>
        </div>
    </div>

    <script>
        async function loadData() {
            try {
                // Load Upcoming
                const predResponse = await fetch('predictions.json');
                if (predResponse.ok) {
                    const predictions = await predResponse.json();
                    populateTable('#upcoming-table tbody', predictions, false);
                }

                // Load Past Results
                const resultResponse = await fetch('past_results.json');
                if (resultResponse.ok) {
                    const results = await resultResponse.json();
                    populateTable('#past-table tbody', results, true);
                }

                // Load Accuracy
                const accResponse = await fetch('accuracy.json');
                if (accResponse.ok) {
                    const acc = await accResponse.json();
                    document.getElementById('accuracy-value').textContent = acc.accuracy + '%';
                    document.getElementById('accuracy-detail').textContent =
                        `(${acc.correct}/${acc.evaluated} correct, ${acc.pending} pending)`;
                } else {
                    document.getElementById('accuracy-value').textContent = 'N/A';
                }

                document.getElementById('last-updated').textContent = `Last updated: ${new Date().toLocaleDateString()}`;

            } catch (error) {
                console.error("Error loading data:", error);
            }
        }

        function populateTable(selector, data, isPast) {
            const tableBody = document.querySelector(selector);
            tableBody.innerHTML = '';

            data.forEach(item => {
                const row = document.createElement('tr');

                const matchCell = document.createElement('td');
                matchCell.textContent = `${item.HomeTeam} vs ${item.AwayTeam}`;

                const predCell = document.createElement('td');
                predCell.className = 'score';
                predCell.textContent = item.PredictedScore;

                row.appendChild(matchCell);
                row.appendChild(predCell);

                if (isPast) {
                    const actualCell = document.createElement('td');
                    actualCell.className = 'actual-score';
                    actualCell.textContent = item.ActualScore;
                    row.appendChild(actualCell);
                } else {
                    const xgCell = document.createElement('td');
                    xgCell.style.color = '#777';
                    xgCell.style.fontSize = '0.9em';
                    xgCell.textContent = `${Number(item.HomeGoals_Exp).toFixed(1)} - ${Number(item.AwayGoals_Exp).toFixed(1)}`;
                    row.appendChild(xgCell);
                }

                tableBody.appendChild(row);
            });
        }

        loadData();
    </script>
</body>

</html>